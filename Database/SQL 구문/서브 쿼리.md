# 서브 쿼리

* 다른 쿼리 내부에 포함되어 있는 SELECT 문을 의미함
* 외부쿼리/메인쿼리
  * 서브쿼리를 포함하고 있는 쿼리
* 서브쿼리
  * 내부쿼리
* 서브쿼리는 비교 연산자의 오른쪽에 기술해야 하고 반드시 `()`로 감싸져 있어야만 함

<br>

#### 서브쿼리 종류

* 중첩 서브 쿼리

  * WHERE 문에 작성하는 서브 쿼리

  * 단일 행 : `=`, `>`, `<`
  * 복수(다중) 행 : `IN`, `ANY`, `ALL`
  * 다중 컬럼

* 인라인 뷰

  * FROM 문에 작성하는 서브 쿼리

* 스칼라 서브 쿼리

  * SELECT 문에 작성하는 서브 쿼리

<BR>

#### 주의사항

* 서브쿼리는 반드시 `()`로 감싸야 함
* 서브쿼리는 단일 행 또는 다중 행 비교 연산자와 함께 사용됨

<br>

#### 서브 쿼리가 사용이 가능한 곳

* SELECT
* FROM
* WHERE
* HAVING
* ORDER BY
* INSERT문의 VALUES
* UPDATE문의 SET/WHERE절
* DELETE문의 WHERE절

<br>

---

<br>

## 서브쿼리 종류

#### Nested Subquery

* WHERE 절에 사용됨

* 서브 쿼리의 결과가 **단일행**을 리턴 : `=`, `<`, `>`
* 서브 쿼리의 결과가 **다중행**을 리턴 : `IN`, `ANY`, `ALL`
  * `ANY` : 하나만이라도 만족한다면
  * `ALL` : 모두 만족 한다면
  * 상호연관 서브쿼리 검색!!
* 서브 쿼리의 결과가 **다중컬럼**을 리턴

<br>

#### 인라인 뷰

* FROM 절에 사용됨
* 서브 쿼리가 FROM 절에 사용되면 뷰처럼 결과가 동적으로 생성된 테이블로 사용 가능
* 임시적인 뷰이기 때문에 데이터베이스에는 저장되지 않음
* 동적으로 생성된 테이블이기 떄문에 column을 자유롭게 참조 가능

* **TopN 질의**
  * 300개를 가져왔을 때 1페이지당 10개씩 보여줄떄 사용

* **limit 활용**
  * `limit 10, 5` : 순위가 11인 행부터 5개 뽑아와라~
  * TopN 질의와 같음... 사용법이 더 쉬우니 이거 사용!
  * 쿼리문 맨 마지막에 씀
  * MySql에만 있음 (+mariadb)

<br>

#### 스칼라 서브 쿼리

* SELECT 절에 있는 서브 쿼리
* 한 개의 행만 반환

<br>

#### 서브 쿼리를 이용한

* CREATE
* INSERT
* UPDATE
* DELETE