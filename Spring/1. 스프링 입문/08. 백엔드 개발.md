# 08. 백엔드 개발

> 회원 관리 예제

#### 진행 순서

1. 비즈니스 요구사항 정리
2. 회원 도메인과 리포지토리 만들기
3. 회원 리포지토리 테스트 케이스 작성
4. 회원 서비스 개발
5. 회원 서비스 테스트

<br>

---

<br>

## 1) 비즈니스 요구사항 정리

* 데이터 : 회원ID, 회원이름
* 기능 : 회원 등록, 조회
* 데이터 저장소 : ? (아직 데이터 저장소가 선정되지 않음)

<br>

#### 일반적인 웹 애플리케이션 계층 구조

![일반적인웹애플리케이션계층구조](https://user-images.githubusercontent.com/71495290/179712521-44faf27f-5048-498f-b93c-f29c5669cc0a.jpeg)

* 컨트롤러 : 웹 MVC의 컨트롤러 역할
* 서비스 : 핵심 비즈니스 로직 구현
* 리포지토리 : 데이터베이스에 접근, 도메인 객체를 DB에 저장하고 관리
* 도메인 : 비즈니스 도메인 객체
  * 예) 회원, 주문, 쿠폰 등등 주로 데이터베이스에 저장하고 관리됨

<br>

#### 클래스 의존관계

![클래스의존관계](https://user-images.githubusercontent.com/71495290/179713094-2646177f-231d-41ca-a830-46ef3a7141cd.PNG)

* 아직 데이터 저장소가 선정되지 않아서, 우선 인터페이스로 구현 클래스를 변경할 수 있도록 설계
* 데이터 저장소는 RDB, NoSQL 등등 다양한 저장소를 고민중인 상황으로 가정
* 개발을 진행하기 위해서 초기 개발 단계에서는 구현체로 가벼운 메모리 기반의 데이터 저장소 사용

<br>

---

<br>

## 2) 회원 도메인과 리포지토리 만들기

> *pass*

<br>

---

<br>

## 3) 회원 리포지토리 테스트 케이스 작성

* 개발한 기능을 실행해서 테스트 할 때 main 메서드를 통해서 실행하거나, 웹 애플리케이션의 컨트롤러를 통해서 해당 기능을 실행함.
* 하지만, 이러한 방법은 준비하고 실행하는데 오래 걸리고 반복 실행하기 어렵고 여러 테스트를 한번에 실행하기 어렵다는 단점이 있음
* 그래서! **자바는 JUnit이라는 프레임 워크로 테스트를 실행**해서 이러한 문제를 해결함!!

<br>

#### 1. 직접 하나하나 테스트 코드 작성해보기

1. `test` 폴더 하위에 테스트 할 패키지 이름과 같은 패키지를 새롭게 만든다.
2. 해당 패키지에 테스트 할 클래스 이름과 같은 클래스를 새롭게 만든다.
   * 단, 이름은 마지막에 `Test`를 붙여준다.
3. `@Test` 태그를 이용해서 테스트 할 클래스의 메소드와 이름이 같은 메소드들을 작성한다. (테스트 메소드)
4. 테스트는 각각 독립적으로 실행되어야 함. 테스트 순서에 의존관계가 있는 것은 좋은 테스트가 아니므로 `@AfterEach` 태그를 사용한다
   * `@AfterEach` : 한 번에 여러 테스트를 실행하면 메모리 DB에 직전 테스트 결과가 남을 수 있음. 이는 이전 테스트 때문에 다음 테스트가 실패할 가능성이 있음. 따라서 이 태그를 사용하여 DB 초기화 메소드를 구현하고, 각 테스트가 종료될 때마다 초기화가 이뤄질 수 있도록 해야 함.
   * `@BeforeEach` : 각 테스트 실행 전에 호출됨. 테스트가 서로 영향이 없도록 항상 새로운 객체를 생성하고, 의존 관계도 새로 맺어 줌

<br>

#### 2. 자동 완성으로 테스트 코드 작성해보기

* 해당 클래스에 커서를 올리기
* `Ctrl + Shift + T` 단축키 입력
* `Create Test` 클릭 
* 테스트 코드 작성하고 싶은 Member에 체크

```java
// 이런 식으로 껍데기 작성됨
class MemberServiceTest {

    @Test
    void join() {
        // given
        // when
        // then
    }

    @Test
    void findMembers() {
    }

    @Test
    void findOne() {
    }
}
```

<br>

#### TDD

* 테스트 주도 개발
* 테스트를 먼저 만들고, 구현 클래스를 만드는 개발 방법

<br>

#### 추가 Tip

* 테스트 코드의 메소드명
  * 한국인끼리 협업할 경우, 직관적인 **한국어**로 적어도 무방하다 ㅎㅎ
  * `void 회원가입() {}`
* 테스트 메소드는 `given`, `when`, `then` 단계로 작성한다
  * `given` : 어떤 데이터를 기반으로 하는 지
  * `when` : 어떤 것을 검증할 것인지
  * `then` : 검증 결과

<br>

---

<br>

## 
