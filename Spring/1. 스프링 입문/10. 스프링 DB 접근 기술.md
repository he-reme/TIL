# 10. 스프링 DB 접근 기술

> OS : Window

<br>

---

<br>

## H2 데이터베이스

> * 개발이나 테스트 용도로 가볍고 편리한 DB
>
> * 웹 화면 제공

<br>

#### 설치하기

* 설치한 버전 : 1.4.200
* 다운로드한 파일 : Platform-Independent.Zip
  * 그 후 적절한 폴더에 압축 풀기

* https://www.h2database.com/html/download-archive.html

<br>

#### 실행하기

* cmd 열기

* 압축 푼 폴더 접근

  * 명령어 : `cd C:\SpringStudy\study01\h2-2019-10-14\h2\bin`

* 실행하기

  * 명령어 : `h2.bat`

* 연결 전 화면

  ![H2 데이터베이스](https://user-images.githubusercontent.com/71495290/183645345-4fb4128d-986e-4d8d-b092-09b775c706ad.PNG)

* 연결 후 화면

  ![H2 실행화면](https://user-images.githubusercontent.com/71495290/183652409-e3985a9c-e75f-48c0-a529-9449018a1563.PNG)

* 참고

  * 만약 제대로 실행되지 않고 무한로딩일 경우 URL에서 아이피 지우고, 그 자리에 `localhost` 입력

<br>

#### 최초 접속 시

1. 연결하기

   * JDBC URL : `jdbc:h2:~/test`

   * 사용자명 : `sa`

   * 비밀번호 : 없음

   * `연결 버튼` 클릭

2. 데이터베이스 연결끊기

   * `맨 왼쪽 상단 버튼` 클릭

3. 데이터베이스 파일 생성 됐는 지 확인

   * home 디렉토리에 `test.mv.db` 파일이 있는지 확인
   * `dir` 명령어로 파일 목록 검색

<br>

#### 그 이후 접속 시

* JDBC URL을 `jdbc:h2:tcp://localhost/~/test`로 변경
* 변경하는 이유
  * JDBC URL이 `jdbc:h2:~/test`인 경우 파일로 직접 접근하는 방식이기 때문에
  * 애플리케이션과 웹콘솔이 동시에 접근하려고 할 때 충돌이 일어날 수 있음
  * 따라서 파일로 직접 접근하는 방식이 아닌, 패킷으로 접근하는 방식으로 변경한 것임.

<br>

#### SQL문 작성

* 테이블 생성하기

  ```sql
  drop table if exists member CASCADE;
  create table member
  (
  	id bigint generated by default as identity,
  	name varchar(255),
  	primary key (id)
  );
  ```

* 데이터 입력

  ```sql
  insert into member(name) values('spring')
  ```

  